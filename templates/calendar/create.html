{% extends "base.html" %}

{% block title %}ì¼ì • ë“±ë¡ - ì»¤í”Œ ì•±{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>ğŸ“… ì¼ì • ë“±ë¡</h1>
        <p>ìƒˆë¡œìš´ ì¼ì •ì„ ë“±ë¡í•˜ì„¸ìš”</p>
    </div>
    
    <div class="card">
        <div class="card-body">
            <form method="POST" class="form" data-validate>
                <div class="form-group">
                    <label for="title">ì œëª© <span class="required">*</span></label>
                    <input type="text" id="title" name="title" 
                           class="form-control" 
                           placeholder="ì¼ì • ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                           data-validate="required|max:100"
                           required>
                </div>
                
                <div class="form-group">
                    <label for="description">ì„¤ëª…</label>
                    <textarea id="description" name="description" 
                              class="form-control" 
                              rows="3"
                              placeholder="ì¼ì •ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)"
                              data-validate="max:500"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="start_date">ì‹œì‘ ë‚ ì§œ <span class="required">*</span></label>
                        <input type="date" id="start_date" name="start_date" 
                               class="form-control"
                               data-validate="required"
                               required>
                    </div>
                    
                    <div class="form-group col-md-6">
                        <label for="start_time">ì‹œì‘ ì‹œê°„ <span class="required">*</span></label>
                        <input type="time" id="start_time" name="start_time" 
                               class="form-control"
                               data-validate="required"
                               required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="end_date">ì¢…ë£Œ ë‚ ì§œ <span class="required">*</span></label>
                        <input type="date" id="end_date" name="end_date" 
                               class="form-control"
                               data-validate="required"
                               required>
                    </div>
                    
                    <div class="form-group col-md-6">
                        <label for="end_time">ì¢…ë£Œ ì‹œê°„ <span class="required">*</span></label>
                        <input type="time" id="end_time" name="end_time" 
                               class="form-control"
                               data-validate="required"
                               required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="participant_type">ì°¸ì—¬ì <span class="required">*</span></label>
                    <select id="participant_type" name="participant_type" 
                            class="form-control"
                            data-validate="required"
                            required>
                        <option value="">ì°¸ì—¬ìë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="both">ë‘˜ ë‹¤</option>
                        <option value="user1">ë‚˜ë§Œ</option>
                        <option value="user2">íŒŒíŠ¸ë„ˆë§Œ</option>
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="icon-plus"></i> ì¼ì • ë“±ë¡
                    </button>
                    <a href="{{ url_for('calendar.index') }}" class="btn btn-secondary">
                        <i class="icon-arrow-left"></i> ì·¨ì†Œ
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const startDateInput = document.getElementById('start_date');
    const endDateInput = document.getElementById('end_date');
    const startTimeInput = document.getElementById('start_time');
    const endTimeInput = document.getElementById('end_time');
    
    // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
    const today = new Date().toISOString().split('T')[0];
    startDateInput.value = today;
    endDateInput.value = today;
    
    // í˜„ì¬ ì‹œê°„ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
    const now = new Date();
    const currentTime = now.toTimeString().slice(0, 5);
    startTimeInput.value = currentTime;
    
    // ì¢…ë£Œ ì‹œê°„ì„ 1ì‹œê°„ í›„ë¡œ ì„¤ì •
    const endTime = new Date(now.getTime() + 60 * 60 * 1000);
    endTimeInput.value = endTime.toTimeString().slice(0, 5);
    
    // ì‹œì‘ ë‚ ì§œê°€ ë³€ê²½ë˜ë©´ ì¢…ë£Œ ë‚ ì§œë„ ê°™ì´ ë³€ê²½
    startDateInput.addEventListener('change', function() {
        if (endDateInput.value < this.value) {
            endDateInput.value = this.value;
        }
    });
    
    // í¼ ê²€ì¦
    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {
        const startDate = startDateInput.value;
        const startTime = startTimeInput.value;
        const endDate = endDateInput.value;
        const endTime = endTimeInput.value;
        
        if (startDate && startTime && endDate && endTime) {
            const startDateTime = new Date(`${startDate}T${startTime}`);
            const endDateTime = new Date(`${endDate}T${endTime}`);
            
            if (startDateTime >= endDateTime) {
                e.preventDefault();
                alert('ì¢…ë£Œ ì‹œê°„ì€ ì‹œì‘ ì‹œê°„ë³´ë‹¤ ëŠ¦ì–´ì•¼ í•©ë‹ˆë‹¤.');
                return false;
            }
        }
    });
});
</script>
{% endblock %}